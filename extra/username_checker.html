<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Username Checker</title>
    <style>
        /* General Styling */
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #2c3e50;
            color: #ecf0f1;
            margin: 0;
            padding: 0;
        }

        h1 {
            color: #e74c3c;
            margin-top: 20px;
        }

        p {
            color: #bdc3c7;
            font-style: italic;
            margin: 10px auto;
            width: 60%;
            line-height: 1.5;
        }

        /* Textarea and Buttons */
        textarea {
            margin: 10px;
            padding: 10px;
            width: 80%;
            max-width: 600px;
            height: 150px;
            border-radius: 5px;
            border: 1px solid #34495e;
            background-color: #34495e;
            color: #ecf0f1;
            font-size: 16px;
            resize: none;
        }

        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 18px;
            color: #fff;
            background-color: #e74c3c;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background-color: #c0392b;
        }

        #copyButton {
            display: none; /* Hidden initially */
        }

        /* Table Styling */
        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 90%;
            max-width: 800px;
        }

        table, th, td {
            border: 1px solid #34495e;
        }

        th {
            background-color: #e74c3c;
            color: #fff;
            padding: 10px;
        }

        td {
            padding: 10px;
        }

        .error {
            color: #e74c3c;
        }

        .available {
            color: #2ecc71;
            font-weight: bold;
        }

        .unavailable {
            color: #e74c3c;
            font-weight: bold;
        }

        /* Loading Spinner */
        .loading {
            display: none;
            margin: 20px auto;
        }

        /* Footer */
        footer {
            margin-top: 20px;
            font-size: 14px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <h1>Minecraft Username Checker</h1>
    <p>Because this resource was specifically to be used for testing, if you receive the status as 'Error' it means that the API is overloaded. The server it is run on is a free service. Also, some words may be banned by Mojang, and aren't fully accounted for here. You can also try searching fewer usernames at the same time.</p>
    <textarea id="usernames" placeholder="Enter one or more usernames (one per line)"></textarea><br>
    <button onclick="checkUsernames()">Check Availability</button>
    <button id="copyButton" onclick="copyAvailableUsernames()">Copy Available Usernames</button>
    <div class="loading" id="loadingIndicator">
        <img src="https://i.gifer.com/ZZ5H.gif" alt="Loading..." width="50">
        <p>Loading...</p>
    </div>
    <table id="resultsTable" style="display: none;">
        <thead>
            <tr>
                <th>Username</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <footer>Powered by ch4rlesexe - https://github.com/ch4rlesexe/</footer>

    <script>
async function fetchBannedWords() {
    try {
        const response = await fetch('https://www.cs.cmu.edu/~biglou/resources/bad-words.txt');
        if (!response.ok) throw new Error("Failed to fetch banned words list.");
        const text = await response.text();
        return text.split('\n').map(word => word.trim().toLowerCase());
    } catch (error) {
        console.error("Error fetching banned words:", error);
        return [];
    }
}

async function checkUsernames() {
    const bannedWords = await fetchBannedWords();

    const usernames = document.getElementById("usernames").value.split("\n")
        .map(name => name.trim())
        .filter(name => name);

    const resultsTable = document.getElementById("resultsTable");
    const resultsBody = resultsTable.querySelector("tbody");
    const loadingIndicator = document.getElementById("loadingIndicator");
    const copyButton = document.getElementById("copyButton");

    resultsBody.innerHTML = ""; 
    copyButton.style.display = "none";
    resultsTable.style.display = "none";
    loadingIndicator.style.display = "block"; 

    if (usernames.length === 0) {
        alert("Please enter at least one username.");
        loadingIndicator.style.display = "none";
        return;
    }

    const invalidUsernames = usernames.filter(username => {
        const reasons = [];
        if (!/^[a-zA-Z0-9_]{3,16}$/.test(username)) {
            reasons.push("Username must be 3-16 characters long and contain only letters, numbers, or underscores.");
        }
        if (bannedWords.includes(username.toLowerCase())) {
            reasons.push("Username contains banned words.");
        }
        if (reasons.length > 0) {
            username.invalidReasons = reasons;
            return true;
        }
        return false;
    });

    if (invalidUsernames.length > 0) {
        const message = invalidUsernames.map(username => {
            return `${username}:\n- ${username.invalidReasons.join("\n- ")}\n`;
        }).join("\n");
        alert(`The following usernames are invalid:\n\n${message}`);
        loadingIndicator.style.display = "none"; 
        return;
    }

    const availableUsernames = [];

    for (const username of usernames) {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${username}</td>
            <td class="error">Checking...</td>
        `;
        resultsBody.appendChild(row);

        try {
            const response = await fetch(`https://minecraft-render-proxy.onrender.com/check/${username}`);
            if (!response.ok) throw new Error(`API error: ${response.status}`);

            const data = await response.json();

            const statusCell = row.querySelector("td:nth-child(2)");
            const displayName = data.username || username; 
            row.querySelector("td:first-child").textContent = displayName;

            if (data.status === "Unclaimed") {
                statusCell.textContent = "✅ Available";
                statusCell.className = "available";
                availableUsernames.push(displayName);
            } else if (data.status === "Claimed") {
                statusCell.textContent = "❌ Taken";
                statusCell.className = "unavailable";
            } else {
                statusCell.textContent = `Error: ${data.status}`;
                statusCell.className = "error";
            }

            await new Promise(resolve => setTimeout(resolve, 300));
        } catch (error) {
            console.error(`Error for username "${username}":`, error);
            const statusCell = row.querySelector("td:nth-child(2)");
            statusCell.textContent = "Error";
            statusCell.className = "error";
        }
    }

    resultsTable.style.display = "table";
    loadingIndicator.style.display = "none"; 

    if (availableUsernames.length > 0) {
        copyButton.style.display = "block"; 
        copyButton.availableUsernames = availableUsernames; 
    }
}

function copyAvailableUsernames() {
    const availableUsernames = document.getElementById("copyButton").availableUsernames || [];
    if (availableUsernames.length === 0) {
        alert("No available usernames to copy.");
        return;
    }

    navigator.clipboard.writeText(availableUsernames.join("\n"))
        .then(() => alert("Available usernames copied to clipboard!"))
        .catch(err => console.error("Failed to copy usernames:", err));
}
    </script>
</body>
</html>
